(this["webpackJsonpeth-sweep"]=this["webpackJsonpeth-sweep"]||[]).push([[0],{104:function(e,t,n){"use strict";n.r(t);var r=n(8),a=n(15),s=n.n(a),c=n(55),i=n.n(c),o=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,107)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),s(e),c(e)}))},u=(n(67),n(40),n(2)),d=n.n(u),l=n(13),h=n(3),p=n(4),b=n(7),v=n(6),f=n(5),j=n(33),m=n(22),x=n(29),g=n(69),k=g.ERC20,O=g.ERC721,y=n(33).ethers,w=n(86),C=function(){function e(t,n,r,a,s){Object(h.a)(this,e),this.provider=t,this.account=n,this.APIKeyString=r,this.to=a,this.chainId=s}return Object(p.a)(e,[{key:"sendAllEth",value:function(){var e=Object(l.a)(d.a.mark((function e(){var t,n,r,a,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.provider.getBalance(this.account);case 2:return t=e.sent,e.next=5,this.provider.getGasPrice();case 5:return n=e.sent,r={to:this.to,value:t},e.next=9,this.provider.estimateGas(r);case 9:return a=e.sent,s=y.BigNumber.from(a).mul(y.BigNumber.from(n)),r.value=t.sub(s),e.next=14,this.provider.getSigner().sendTransaction(r);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sendAllTokens",value:function(){var e=Object(l.a)(d.a.mark((function e(t){var n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(x.a)(t);try{for(n.s();!(r=n.n()).done;)a=r.value,new y.Contract(a.address,k).connect(this.provider.getSigner()).transfer(this.to,a.balance).then(console.log).catch(console.error)}catch(s){n.e(s)}finally{n.f()}case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"transferToken",value:function(){var e=Object(l.a)(d.a.mark((function e(t,n){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=new y.Contract(n.address,k).connect(this.provider.getSigner()),e.abrupt("return",r.transfer(t,n.balance));case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getTokenBalances",value:function(){var e=Object(l.a)(d.a.mark((function e(){var t,n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getERC20Tokens();case 2:return t=e.sent,e.next=5,this.getERC721Tokens();case 5:return n=e.sent,e.next=8,this.getAllERC20Balances(t);case 8:return r=e.sent,e.next=11,this.getAllERC721Balances(n);case 11:return a=e.sent,e.abrupt("return",[].concat(Object(m.a)(r),Object(m.a)(a)));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"uniq",value:function(e){var t={};return e.filter((function(e){return!t.hasOwnProperty(e)&&(t[e]=!0)}))}},{key:"getAllERC721Balances",value:function(){var e=Object(l.a)(d.a.mark((function e(t){var n,r,a,s,c,i,o,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=this.uniq(t.contractAddresses),a=this.uniq(t.tokenNames),e.t0=d.a.keys(r);case 4:if((e.t1=e.t0()).done){e.next=27;break}s=e.t1.value,c=Object(x.a)(t.tokenIds[r[s]]),e.prev=7,c.s();case 9:if((i=c.n()).done){e.next=17;break}return o=i.value,e.next=13,this.getStillOwnedERC721(o,r[s]);case 13:e.sent&&((u={}).address=r[s],u.type="ERC721",u.balance=o,u.decimals=0,u.name=a[s],n.push(u));case 15:e.next=9;break;case 17:e.next=22;break;case 19:e.prev=19,e.t2=e.catch(7),c.e(e.t2);case 22:return e.prev=22,c.f(),e.finish(22);case 25:e.next=4;break;case 27:return e.abrupt("return",n);case 28:case"end":return e.stop()}}),e,this,[[7,19,22,25]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllERC20Balances",value:function(){var e=Object(l.a)(d.a.mark((function e(t){var n,r,a,s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],e.t0=d.a.keys(t.contractAddresses);case 2:if((e.t1=e.t0()).done){e.next=17;break}return r=e.t1.value,a=t.contractAddresses[r],e.next=7,this.getERC20Balance(a);case 7:s=e.sent,(c={}).decimals=t.decimals[r],c.address=a,c.balance=s,c.type="ERC20",c.name=t.tokenNames[r],"0"!==s.toString()&&n.push(c),e.next=2;break;case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getStillOwnedERC721",value:function(){var e=Object(l.a)(d.a.mark((function e(t,n){var r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=new y.Contract(n,O).connect(this.provider),e.next=4,r.ownerOf(t);case 4:return a=e.sent,e.abrupt("return",a.toLowerCase()===this.account.toLowerCase());case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getERC20Balance",value:function(){var e=Object(l.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=new y.Contract(t,k).connect(this.provider),e.next=4,n.balanceOf(this.account);case 4:return e.abrupt("return",e.sent);case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getERC20Tokens",value:function(){var e=Object(l.a)(d.a.mark((function e(){var t,n,r,a,s,c,i,o,u,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getQueryERC20Events(this.chainId,this.account),e.prev=1,n={},r=[],a=[],s=[],e.next=8,w(t);case 8:c=e.sent,i=c.body.result,o=Object(x.a)(i);try{for(o.s();!(u=o.n()).done;)l=u.value,r.includes(l.contractAddress)||(r.push(l.contractAddress),a.push(l.tokenName),s.push(l.tokenDecimal))}catch(d){o.e(d)}finally{o.f()}return n.tokenNames=a,n.contractAddresses=r,n.decimals=s,e.abrupt("return",n);case 18:e.prev=18,e.t0=e.catch(1),console.error(e.t0);case 21:case"end":return e.stop()}}),e,this,[[1,18]])})));return function(){return e.apply(this,arguments)}}()},{key:"getERC721Tokens",value:function(){var e=Object(l.a)(d.a.mark((function e(){var t,n,r,a,s,c,i,o,u,l,h;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getQueryERC721Events(this.chainId,this.account),e.prev=1,n={},r=[],a=[],s=[],c={},e.next=9,w(t);case 9:i=e.sent,o=i.body.result,u=Object(x.a)(o);try{for(u.s();!(l=u.n()).done;)h=l.value,r.push(h.contractAddress),a.push(h.tokenName),s.push(h.tokenDecimal),void 0===c[h.contractAddress]&&(c[h.contractAddress]=[]),c[h.contractAddress].includes(h.tokenID)||c[h.contractAddress].push(h.tokenID)}catch(d){u.e(d)}finally{u.f()}return n.tokenNames=a,n.contractAddresses=r,n.decimals=s,n.tokenIds=c,e.abrupt("return",n);case 20:e.prev=20,e.t0=e.catch(1),console.error(e.t0);case 23:case"end":return e.stop()}}),e,this,[[1,20]])})));return function(){return e.apply(this,arguments)}}()},{key:"getQueryERC20Events",value:function(e){switch(e){case 1:return"https://api.etherscan.io/api?module=account&action=tokentx&address="+this.account+this.APIKeyString;case 3:return"https://ropsten.etherscan.io/api?module=account&action=tokentx&address="+this.account+this.APIKeyString;case 4:return"https://rinkeby.etherscan.io/api?module=account&action=tokentx&address="+this.account+this.APIKeyString;case 42:return"https://kovan.etherscan.io/api?module=account&action=tokentx&address="+this.account+this.APIKeyString;default:return"https://api.etherscan.io/api?module=account&action=tokentx&address="+this.account+this.APIKeyString}}},{key:"getQueryERC721Events",value:function(e){switch(e){case 1:return"https://api.etherscan.io/api?module=account&action=tokennfttx&address="+this.account+this.APIKeyString;case 3:return"https://ropsten.etherscan.io/api?module=account&action=tokennfttx&address="+this.account+this.APIKeyString;case 4:return"https://rinkeby.etherscan.io/api?module=account&action=tokennfttx&address="+this.account+this.APIKeyString;case 42:return"https://kovan.etherscan.io/api?module=account&action=tokennfttx&address="+this.account+this.APIKeyString;default:return"https://api.etherscan.io/api?module=account&action=tokennfttx&address="+this.account+this.APIKeyString}}}]),e}(),A=n(106),E=function(e){Object(v.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(h.a)(this,n),(r=t.call(this,e)).props=e,r}return Object(p.a)(n,[{key:"setTransferClick",value:function(e){this.props.helpers.transferToken(this.props.to,e).then(console.log).catch(console.error)}},{key:"render",value:function(){var e=this,t=this.props.balanceObj,n=t.name,a=t.balance,s=t.decimals,c=t.type;try{var i=Object(A.b)(a.toString(),Math.max(parseInt(s.toString()),1));return Object(r.jsx)("div",{children:Object(r.jsxs)("div",{className:"grid-container",children:[Object(r.jsx)("div",{className:"grid-items",children:n}),Object(r.jsx)("div",{className:"grid-items",children:i.toString()}),Object(r.jsx)("div",{className:"grid-items",children:c}),Object(r.jsx)("div",{className:"grid-items",children:Object(r.jsx)("button",{className:"btn btn-primary",onClick:function(){e.setTransferClick(e.props.balanceObj)},children:" Transfer"})})]})})}catch(o){return Object(r.jsx)("div",{})}}}]),n}(a.Component),N=function(e){Object(v.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(h.a)(this,n),(r=t.call(this,e)).props=e,r}return Object(p.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.account,a=t.to,s=t.provider,c=t.helpers,i=this.props.balancesMapping.map((function(e){return Object(r.jsx)(E,{balanceObj:e,account:n,to:a,provider:s,helpers:c})}));return Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{id:"results",children:Object(r.jsxs)("div",{className:"grid-container",children:[Object(r.jsx)("div",{className:"grid-item",children:"Coin"}),Object(r.jsx)("div",{className:"grid-item",children:"Balance"}),Object(r.jsx)("div",{className:"grid-item",children:"Type"}),Object(r.jsx)("div",{className:"grid-item",children:"Action"})]})}),Object(r.jsxs)("div",{className:"grid-container",children:[Object(r.jsx)("div",{className:"grid-items",children:"ETH"}),Object(r.jsx)("div",{className:"grid-items",children:this.props.balance/1e18}),Object(r.jsx)("div",{className:"grid-items",children:"Ether"}),Object(r.jsx)("div",{className:"grid-items",children:Object(r.jsx)("button",{className:"btn btn-danger",id:"sweepAllETH",onClick:function(){e.props.helpers.sendAllEth().then(console.log).catch(console.error)},children:"Sweep All ETH"})})]}),Object(r.jsxs)("div",{className:"grid-container",children:[Object(r.jsx)("div",{className:"grid-items",children:"ALL"}),Object(r.jsx)("div",{className:"grid-items",children:"ALL"}),Object(r.jsx)("div",{className:"grid-items",children:"ALL"}),Object(r.jsx)("div",{className:"grid-items",children:Object(r.jsx)("button",{className:"btn btn-danger",id:"sweepAllTokens",onClick:function(){e.props.helpers.sendAllTokens(e.props.balancesMapping).then(console.log).catch(console.error)},children:"Sweep All Tokens"})})]}),i]})}}]),n}(a.Component),S=function(e){Object(v.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(h.a)(this,n),(r=t.call(this,e)).state={balance:void 0,to:void 0,account:void 0,helpers:void 0,balancesMapping:void 0},r.setReadyClick=r.setReadyClick.bind(Object(b.a)(r)),r.load=r.load.bind(Object(b.a)(r)),r}return Object(p.a)(n,[{key:"load",value:function(){var e=Object(l.a)(d.a.mark((function e(){var t,n,r,a,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.ethereum.enable();case 2:return t=e.sent,n=new j.ethers.providers.Web3Provider(window.web3.currentProvider),e.next=6,n.getBalance(t[0]);case 6:return r=e.sent,this.setState({balance:r}),this.setState({account:t[0]}),a=new C(n,t[0],"&apikey=ANVBH7JCNH1BVHJ1NPB5FH1WKP5C6YSYJW",this.state.to,parseInt(window.ethereum.chainId)),this.setState({helpers:a}),e.next=13,a.getTokenBalances();case 13:s=e.sent,this.setState({balancesMapping:s}),document.getElementById("loading").hidden=!0;case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setReadyClick",value:function(){var e=document.getElementById("transferTo").value;if(!j.ethers.utils.isAddress(e))return alert("Invalid address provided, please try again");document.getElementById("loading").hidden=!1,this.setState({to:e}),this.load()}},{key:"render",value:function(){var e;return this.state.balancesMapping&&(e=Object(r.jsx)(N,{balance:this.state.balance.toString(),account:this.state.account,helpers:this.state.helpers,to:this.state.to,balancesMapping:this.state.balancesMapping})),Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{className:"jumbotron",children:Object(r.jsxs)("div",{id:"titles",children:[Object(r.jsx)("h1",{children:"eth-sweep"}),Object(r.jsx)("h2",{children:"Sweep your ethereum wallet"})]})}),Object(r.jsxs)("div",{id:"startBox",children:[Object(r.jsx)("input",{id:"transferTo",type:"text",placeholder:"Paste the ethereum address you wish to transfer to"}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("button",{className:"btn btn-primary",id:"ready",onClick:this.setReadyClick,children:" Begin "}),Object(r.jsx)("h3",{id:"loading",hidden:!0,children:"Loading, please wait..."})]}),Object(r.jsx)("br",{}),e]})}}]),n}(a.Component);var I=function(){return Object(r.jsx)("div",{children:Object(r.jsx)(S,{})})};i.a.render(Object(r.jsx)(s.a.StrictMode,{children:Object(r.jsx)(I,{})}),document.getElementById("root")),o()},40:function(e,t,n){},69:function(e,t){e.exports={ERC20:["function balanceOf(address owner) view returns (uint256)","function transfer(address to, uint amount) returns (bool)","function allowance(address spender, address owner) view returns(uint256)","function approve(address spender, uint amount) returns (bool)"],ERC721:["function ownerOf(uint256 _tokenId) external view returns (address)"]}},70:function(e,t){},77:function(e,t){},98:function(e,t){}},[[104,1,2]]]);
//# sourceMappingURL=main.fd90aec7.chunk.js.map